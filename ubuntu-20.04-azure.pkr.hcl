packer {
  required_plugins {
    azure = {
      version = ">= 1.0.0"
      source  = "github.com/hashicorp/azure"
    }
  }
}



variable "build_id" {
  type    = string
  default = "local"
}

variable "platform" {
  type    = string
  default = "unknown"
}

variable "managed_image_rg" {
  type        = string
  description = "The destination resource group for the managed image."
}

variable "location" {
  type        = string
  description = "The Azure region where temporary resources will be created for the build."
}

source "azure-arm" "autogenerated" {
  use_azure_cli_auth = true
  image_offer     = "0001-com-ubuntu-server-focal"
  image_publisher = "canonical"
  image_sku       = "20_04-lts-gen2"
  os_type         = "Linux"
  
  managed_image_name                       = "ubuntu-20-04-${var.build_id}"
  managed_image_resource_group_name        = var.managed_image_rg
  
  location                                 = var.location
  
  vm_size         = "Standard_DS2_v2"
  
  
  
}

build {
  sources = ["source.azure-arm.autogenerated"]
}